{% import 'utility/icons.html.twig' as icon %}

<!DOCTYPE html>
<html class="h-100">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>{% block title %}Welcome!{% endblock %}</title>
        {# Run `composer require symfony/webpack-encore-bundle`
           and uncomment the following Encore helpers to start using Symfony UX #}
        {% block stylesheets %}
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta3/dist/css/bootstrap-select.min.css">
            <link href="https://cdn.jsdelivr.net/npm/tom-select@2.1.0/dist/css/tom-select.css" rel="stylesheet">
            <link rel="stylesheet" href="{{ asset("icomoon/style.css") }}">
            <link rel="stylesheet" href="{{ asset("build/app.css") }}">
        {% endblock %}

        {% block javascripts %}
            <script src="https://d3js.org/d3.v7.min.js"></script>
            {{ encore_entry_script_tags('app') }}
        {% endblock %}

        {# <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/tom-select@2.1.0/dist/js/tom-select.complete.min.js"></script>

        <script src="https://unpkg.com/smiles-drawer@1.2.0/dist/smiles-drawer.min.js" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta3/dist/js/bootstrap-select.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/jquery.fancytable/dist/fancyTable.min.js"></script>
        <script src="https://unpkg.com/html5-qrcode"></script>

        <script src="https://cdn.jsdelivr.net/gh/calipho-sib/sequence-viewer@master/dist/sequence-viewer.min.js" defer></script>
        <script type="application/javascript" defer>
            $(document).ready(function () {
                let viewers = $(".gin-sequenceViewer")

                viewers.each(function (e) {
                    let sequence = new Sequence(this.innerText);

                    sequence.render("#" + this.id, {
                        'showLineNumbers': true,
                        'wrapAminoAcids': true,
                        'charsPerLine': 100,
                        'toolbar': true,
                        'search': true,
                        'title': this.hasAttribute("data-gin-sequence-title") ? this.getAttribute("data-gin-sequence-title") : "Sequence Viewer",
                        'header' : {
                            display:true,
                            searchInTitle :true,
                            unit: "Char",
                            showCpl: false,
                            badgeWithUnit : false
                        }
                    })
                })
            });
        </script> #}

        <style rel="stylesheet">
            label.required:after {
                content: "* ";
            }

            .text-light span.icon .path1:before {
                color: #f6f6f6;
            }

            .text-light span.icon .path2:before {
                color: #777777;
            }


            .list-group.list-group-root {
                padding: 0;
                overflow: hidden;
            }

            .list-group.list-group-root .list-group {
                margin-bottom: 0;
            }

            .list-group.list-group-root .list-group-item {
                border-radius: 0;
                border-width: 1px 0 0 0;
            }

            .list-group.list-group-root > .list-group-item:first-child {
                border-top-width: 0;
            }

            .list-group.list-group-root > .list-group > .list-group-item {
                padding-left: 40px;
            }

            .list-group.list-group-root > .list-group > .list-group > .list-group-item {
                padding-left: 80px;
            }

            .list-group.list-group-root > .list-group > .list-group > .list-group > .list-group-item {
                padding-left: 120px;
            }

            .list-group.list-group-root > .list-group > .list-group > .list-group > .list-group .list-group-item {
                padding-left: 160px;
            }

            .list-group.list-group-root > .list-group > .list-group > .list-group > .list-group > .list-group .list-group-item {
                padding-left: 200px;
            }

            form .tab-content fieldset {
                border-top: 1px solid grey;
                border-bottom: 1px solid grey;
            }

            form .tab-content fieldset > legend.col-form-label {
                font-weight: bold;
                font-size: 120%;
            }

            form .tab-content fieldset > div {
                padding-left: 1em;
            }
        </style>
    </head>
    <body class="h-100">
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <div class="container-fluid">
                <a class="navbar-brand" href="{{ url("app_homepage") }}">Gin {% if app.request.server.get('GENIE_VERSION') %} (v{{ app.request.server.get('GENIE_VERSION') }}){% endif %}</a>

                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="border-end border-1 my-2" style="border-color: rgb(255, 255, 255, 0.55) !important;"></li>

                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="{{ url("app_cells") }}" id="navbar-dropdown-cell-link" role="button" data-toggle="dropdown" aria-haspopup="true">
                                {{ icon.cell() }}
                                Cells
                            </a>

                            <div class="dropdown-menu" aria-labelledby="navbar-dropdown-cell-link">
                                <a class="dropdown-item" href="{{ url("app_cells") }}">{{ icon.cell() }}Overview</a>
                                <a class="dropdown-item" href="{{ url("app_cells_all") }}">{{ icon.cell() }}All cells</a>
                                {% if app.user %}<a class="dropdown-item" href="{{ url("app_cell_add") }}"><span class="fas fa-fw fa-plus"></span>Add cell</a>{% endif %}

                                {% if app.user %}
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="{{ url("app_cell_cultures") }}"><span class="fas fa-fw fa-flask"></span>Cell Cultures</a>
                                {% endif %}
                            </div>
                        </li>

                        {% if app.user %}
                        <li class="border-end border-1 my-2" style="border-color: rgb(255, 255, 255, 0.55) !important;"></li>

                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="{{ url("app_antibodies") }}" id="navbar-dropdown-antibody-link" role="button" data-toggle="dropdown" aria-haspopup="true">
                                {{ icon.antibody() }}
                                Antibodies
                            </a>

                            <div class="dropdown-menu" aria-labelledby="navbar-dropdown-antibody-link">
                                <a class="dropdown-item" href="{{ url("app_antibodies") }}"><span class="fas fa-fw"></span>All</a>
                                <a class="dropdown-item" href="{{ url("app_antibodies", {"antibodyType": "primaries"}) }}">{{ icon.antibody_primary() }} Primaries</a>
                                <a class="dropdown-item" href="{{ url("app_antibodies", {"antibodyType": "secondaries"}) }}">{{ icon.antibody_secondary() }} Secondaries</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="{{ url("app_substance_new", {"type": "antibody"}) }}"><span class="fas fa-fw fa-plus"></span>New Antibody</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="{{ url("app_epitopes") }}">{{ icon.epitope() }}Epitopes</a>
                            </div>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="{{ url("app_compounds") }}">
                                {{ icon.chemical() }}
                                Chemicals
                            </a>
                        </li>

                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="{{ url("app_oligos") }}" id="navbar-dropdown-oligo-link" role="button" data-toggle="dropdown" aria-haspopup="true">
                                {{ icon.oligo() }}
                                Oligos
                            </a>

                            <div class="dropdown-menu" aria-labelledby="navbar-dropdown-oligo-link">
                                <a class="dropdown-item" href="{{ url("app_substance_import", {"type": "oligo"}) }}">
                                    <span class="fas fa-fw fa-file-import"></span>
                                    Import
                                </a>
                            </div>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="{{ url("app_plasmids") }}">
                                {{ icon.plasmid() }}
                                Plasmids
                            </a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="{{ url("app_proteins") }}">
                                {{ icon.protein() }}
                                Proteins
                            </a>
                        </li>

                        <li class="border-end border-1 my-2" style="border-color: rgb(255, 255, 255, 0.55) !important;"></li>

                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="{{ url("app_storage") }}"  id="navbar-dropdown-storage-link" role="button" data-toggle="dropdown" aria-haspopup="true">
                                {{ icon.rack() }}
                                Storage
                            </a>

                            <div class="dropdown-menu" aria-labelledby="navbar-dropdown-storage-link">
                                <a class="dropdown-item" href="{{ url("app_storage_add_rack") }}">
                                    <span class="gin-icon-stack gin-icon-stack-fw">
                                        <span class="{{ icon.rack(true) }} gin-icon-left"></span>
                                        <span class="{{ icon.add(true) }} gin-icon-right"></span>
                                    </span>
                                    New Location
                                </a>
                                <a class="dropdown-item" href="{{ url("app_storage_add_box") }}">
                                    <span class="gin-icon-stack gin-icon-stack-fw">
                                        <span class="{{ icon.box(true) }} gin-icon-left"></span>
                                        <span class="{{ icon.add(true) }} gin-icon-right"></span>
                                    </span>
                                    New Box
                                </a>
                            </div>
                        </li>

                        <li class="nav-item">
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="{{ url("app_instruments") }}">
                                <span class="fas fa-fw fa-hdd"></span>
                                Instruments
                            </a>
                        </li>

                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="{{ url("app_consumables") }}" id="navbar-dropdown-consumables-link" role="button" data-toggle="dropdown" aria-haspopup="true">
                                <span class="fas fa-fw fa-cookie-bite"></span>
                                Consumables
                            </a>

                            <div class="dropdown-menu" aria-labelledby="navbar-dropdown-consumables-link">
                                <a class="dropdown-item" href="{{ url("app_consumables_to_order") }}">
                                    <span class="gin-icon-stack gin-icon-stack-fw">
                                        <span class="fas fa-fw fa-cookie-bite gin-icon-left"></span>
                                        <span class="fas fa-fw fa-search gin-icon-right"></span>
                                    </span>
                                    To-Order list
                                </a>
                                <a class="dropdown-item" href="{{ url("app_consumables_to_order_critical") }}">
                                    <span class="gin-icon-stack gin-icon-stack-fw">
                                        <span class="fas fa-fw fa-cookie-bite gin-icon-left"></span>
                                        <span class="fas fa-fw fa-search gin-icon-right"></span>
                                    </span>
                                    Must-Order list
                                </a>
                            </div>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="{{ url("app_experiments") }}">
                                <span class="fas fa-fw fa-flask"></span>
                                Experiments
                            </a>
                        </li>

                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" id="navbar-dropdown-other-link" role="button" data-toggle="dropdown" aria-haspopup="true">
                                <span class="fas fa-fw fa-ellipsis-v"></span>
                                Others
                            </a>

                            <div class="dropdown-menu" aria-labelledby="navbar-dropdown-other-link">
                                <a class="dropdown-item" href="{{ url("app_recipes") }}">
                                    <span class="fas fa-fw fa-list-alt"></span>
                                    Recipes
                                </a>

                                <a class="dropdown-item" href="{{ url("app_vendors") }}">
                                    {{ icon.vendor() }}
                                    Vendors
                                </a>

                                <a class="dropdown-item" href="{{ url("app_consumables_to_order_critical") }}">
                                    <span class="fas fa-fw fa-link"></span>
                                    Ressources
                                </a>
                            </div>
                        </li>

                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="{{ url("app_user") }}" id="navbar-dropdown-user-link" role="button" data-toggle="dropdown" aria-haspopup="true">
                                <span class="fas fa-fw fa-user"></span>
                                User
                            </a>

                            <div class="dropdown-menu" aria-labelledby="navbar-dropdown-user-link">
                                {% if is_granted("new", "User") %}
                                    <a class="dropdown-item" href="{{ url("app_user_add") }}">{{ icon.add() }} New User</a>
                                {% endif %}

                                <a class="dropdown-item" href="{{ url("app_group") }}"><span class="fas fa-fw fa-users"></span> Group</a>


                                {% if is_granted("ROLE_ADMIN") %}
                                    <a class="dropdown-item">
                                        <span class="gin-icon-stack gin-icon-stack-fw">
                                            <span class="fas fa-fw fa-users gin-icon-left"></span>
                                            <span class="{{ icon.add(true) }} gin-icon-right"></span>
                                        </span>
                                        Add Group
                                    </a>
                                {% endif %}

                                <div class="dropdown-divider"></div>

                                {% if is_granted("ROLE_ADMIN") %}
                                    <a class="dropdown-item" href="{{ url("admin") }}"><span class="fas fa-fw fa-tools"></span> Administration</a>
                                {% endif %}
                                <a class="dropdown-item" href="{{ logout_url(key = null) }}"><span class="fas fa-sign-out-alt fa-fw"></span> Logout</a>
                            </div>
                        </li>
                        {% endif %}
                    </ul>

                    {% block search %}{% endblock %}
                </div>
            </div>
        </nav>

        {% block body %}{% endblock %}

        {% block script_bottom %}{% endblock %}
    </body>
</html>
